---
- name: Configure Time Server
  hosts: all
  become: true
  tasks:

    # Install the chrony package
    - name: Install chrony package
      yum:
        name: chrony
        state: present

    # Enable and start the chrony service
    - name: Enable and start chrony service
      service:
        name: chronyd
        state: started
        enabled: true

    # Configure the NTP servers
    - name: Configure NTP servers in chrony.conf
      lineinfile:
        path: /etc/chrony.conf
        regexp: "^server"
        line: "server time.google.com iburst"
        state: present
      notify:
        - Restart chrony